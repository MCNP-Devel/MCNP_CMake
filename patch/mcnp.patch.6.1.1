diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/import/frgcpa_.inc MCNP_CODE/MCNP611/Source_new/import/frgcpa_.inc
--- MCNP_CODE/MCNP611/Source/import/frgcpa_.inc
+++ MCNP_CODE/MCNP611/Source_new/import/frgcpa_.inc
@@ -2,0 +3 @@
+#ifdef __INTEL_COMPILER
@@ -3,0 +5 @@
+#endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/import/frgspa_.inc MCNP_CODE/MCNP611/Source_new/import/frgspa_.inc
--- MCNP_CODE/MCNP611/Source/import/frgspa_.inc
+++ MCNP_CODE/MCNP611/Source_new/import/frgspa_.inc
@@ -2,0 +3 @@
+#ifdef __INTEL_COMPILER
@@ -3,0 +5 @@
+#endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/cgm_interface.F90 MCNP_CODE/MCNP611/Source_new/src/cgm_interface.F90
--- MCNP_CODE/MCNP611/Source/src/cgm_interface.F90
+++ MCNP_CODE/MCNP611/Source_new/src/cgm_interface.F90
@@ -28,0 +29,4 @@
+#ifdef __INTEL_COMPILER >= 1600
+      import :: c_funptr
+      type(c_funptr), value :: rngfunc
+#else
@@ -30,0 +35 @@
+#endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/charged_particle_history.F90 MCNP_CODE/MCNP611/Source_new/src/charged_particle_history.F90
--- MCNP_CODE/MCNP611/Source/src/charged_particle_history.F90
+++ MCNP_CODE/MCNP611/Source_new/src/charged_particle_history.F90
@@ -594 +594,5 @@
-          call uplpos(xt,uold,pbl%i%lev,D,v,0)
+          if (am /= one) then
+            call uplpos(xt,uold,pbl%i%lev,D,v,1)
+          else
+            call uplpos(xt,uold,pbl%i%lev,D,v,0)
+          endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/exemes.F90 MCNP_CODE/MCNP611/Source_new/src/exemes.F90
--- MCNP_CODE/MCNP611/Source/src/exemes.F90
+++ MCNP_CODE/MCNP611/Source_new/src/exemes.F90
@@ -273 +273 @@
-      select case( hm(js) )
+      select case( trim(hm(js)) )
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/imcn.F90 MCNP_CODE/MCNP611/Source_new/src/imcn.F90
--- MCNP_CODE/MCNP611/Source/src/imcn.F90
+++ MCNP_CODE/MCNP611/Source_new/src/imcn.F90
@@ -36,0 +37,3 @@
+#ifdef __INTEL_COMPILER >= 1600
+  use, intrinsic :: iso_c_binding
+#endif
@@ -2033 +2036,5 @@
-      call setrngcgm(rang)          
+#ifdef __INTEL_COMPILER >= 1600
+      call setrngcgm(c_funloc(rang))
+#else
+      call setrngcgm(rang)
+#endif
@@ -2299 +2306,5 @@
-      call setrngcgm(rang)          
+#ifdef __INTEL_COMPILER >= 1600
+      call setrngcgm(c_funloc(rang))
+#else
+      call setrngcgm(rang)
+#endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/main.F90 MCNP_CODE/MCNP611/Source_new/src/main.F90
--- MCNP_CODE/MCNP611/Source/src/main.F90
+++ MCNP_CODE/MCNP611/Source_new/src/main.F90
@@ -64 +64 @@
-  use mcnp_env, only : HDPTH0, KOD, LODDAT, VER
+  use mcnp_env, only : hdpth0, kod, loddat, ver
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/mcnp_env.F90 MCNP_CODE/MCNP611/Source_new/src/mcnp_env.F90
--- MCNP_CODE/MCNP611/Source/src/mcnp_env.F90
+++ MCNP_CODE/MCNP611/Source_new/src/mcnp_env.F90
@@ -0,0 +1,46 @@
+
+  module mcnp_env
+    !
+    ! code & environment info for mcnp
+    !
+
+    character(len=8), parameter ::  kod            = KODE
+    character(len=5), parameter ::  ver            = VERS
+    character(len=20),parameter ::  thread         = THREAD
+    character(len=20),parameter ::  thread_version = TVERS
+    character(len=8), parameter ::  loddat         = LODDAT
+    character(len=*), parameter ::  hdpth0         = DPATH
+
+    public ::  print_build_info
+  CONTAINS
+    subroutine print_build_info( iunit )
+      integer, intent(in) :: iunit
+
+      write(iunit,*) '  +-----------------------------------------------------------'
+      write(iunit,*) '  | mcnp6 build information:'
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   user          ='
+      write(iunit,*) '  |   host          ='
+      write(iunit,*) '  |   OS            ='
+      write(iunit,*) '  |   date          ='
+      write(iunit,*) '  |   time          ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   CONFIG        ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   f90           ='
+      write(iunit,*) '  |   OpenMP        ='
+      write(iunit,*) '  |   MPI           ='
+      write(iunit,*) '  |   MPI_ROOT      ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   code          ='
+      write(iunit,*) '  |   version       ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   thread name   ='
+      write(iunit,*) '  |   thread number ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   datapath      ='
+      write(iunit,*) '  |'
+      write(iunit,*) '  |   fpp defs      ='
+      write(iunit,*) '  +-----------------------------------------------------------'
+    end subroutine print_build_info
+  end module mcnp_env
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/msgtsk.F90 MCNP_CODE/MCNP611/Source_new/src/msgtsk.F90
--- MCNP_CODE/MCNP611/Source/src/msgtsk.F90
+++ MCNP_CODE/MCNP611/Source_new/src/msgtsk.F90
@@ -80,0 +81,3 @@
+#ifdef __INTEL_COMPILER >= 1600
+  use, intrinsic :: iso_c_binding
+#endif
@@ -308 +311,5 @@
-    call setrngcgm(rang) 
+#ifdef __INTEL_COMPILER >= 1600
+    call setrngcgm(c_funloc(rang))
+#else
+    call setrngcgm(rang)
+#endif
diff -rN '--unified=0' MCNP_CODE/MCNP611/Source/src/pblcom.F90 MCNP_CODE/MCNP611/Source_new/src/pblcom.F90
--- MCNP_CODE/MCNP611/Source/src/pblcom.F90
+++ MCNP_CODE/MCNP611/Source_new/src/pblcom.F90
@@ -178,4 +178,6 @@
-  common /pblcom_thread/ pbl, pbl_src, pbl_stack
-  common /pblcom_thread/ udt, udt_stack
-  common /pblcom_thread/ pbl_in_use, udt_in_use, is_uncollided_part
-  !$OMP THREADPRIVATE( /pblcom_thread/ )
+  common /pblcom_thread1/ pbl, pbl_src, pbl_stack
+  common /pblcom_thread2/ udt, udt_stack
+  common /pblcom_thread3/ pbl_in_use, udt_in_use, is_uncollided_part
+  !$OMP THREADPRIVATE( /pblcom_thread1/ )
+  !$OMP THREADPRIVATE( /pblcom_thread2/ )
+  !$OMP THREADPRIVATE( /pblcom_thread3/ )
